<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>가따후 5000 system</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#7dd3fc;--muted:#9aa6b2;--glass: rgba(255,255,255,0.03)}
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial; margin:0; background:linear-gradient(180deg,#071026 0%, #081226 100%); color:#e6eef6; min-height:100vh; display:flex; align-items:center; justify-content:center; padding:12px}
    .app{width:100%; max-width:980px}
    header{display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap: wrap;}
    h1{margin:0;font-size:20px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.04); padding:18px; border-radius:12px; box-shadow: 0 6px 30px rgba(2,6,23,0.6)}
    .grid{display:grid; grid-template-columns: 1fr; gap:12px; margin-top:12px}
    .panel{padding:14px}
    .status{display:flex; gap:12px; align-items:center}
    .big{font-size:28px; font-weight:600}
    .muted{color:var(--muted)}
    .controls{display:flex; gap:8px; margin-top:12px; flex-wrap: wrap;}
    button{background:var(--accent); color:#052025; border:0; padding:10px 14px; border-radius:10px; font-weight:600; cursor:pointer; flex-grow: 1; min-width: 80px;}
    button.lose{background:transparent; color:#fca5a5; border:1px solid rgba(255,255,255,0.06)}
    .log{height:200px; overflow:auto; background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00)); border-radius:10px; padding:10px; border:1px solid rgba(255,255,255,0.03)}
    .row{display:flex; justify-content:space-between; padding:6px 8px; border-bottom:1px dashed rgba(255,255,255,0.02)}
    .small{font-size:12px}
    .pill{background:var(--glass); padding:6px 10px; border-radius:999px; font-weight:600}
    .footer{margin-top:12px; display:flex; gap:8px; justify-content:space-between; align-items:center; flex-wrap: wrap;}
    .hint{font-size:12px; color:var(--muted)}
    input[type=number]{width:100px;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    
    .big-button {
      padding: 16px 24px;
      font-size: 1em;
    }
    .disclaimer {
      margin-top: 16px;
      font-size: 12px;
      color: #fca5a5;
      text-align: center;
    }
    .controls .start-unit-wrapper {
        display: flex;
        gap: 8px;
        align-items: center;
        flex-grow: 1;
        justify-content: flex-end;
    }
    .controls .start-unit-wrapper input {
        width: 60px;
    }
    .log-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      flex-wrap: wrap;
    }
    .log-header > div {
      min-width: 100%;
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div>
        <h1>가따후 5000 system</h1>
        <div class="muted small">승/패 버튼으로 진행 — 규칙표(1 → 5000) 반영</div>
      </div>
      <div class="pill">만든이: 유리화 (자동 변환)</div>
    </header>

    <div class="grid">
      <div class="card panel">
        <div class="status">
          <div>
            <div class="muted small">현재 유닛</div>
            <div id="current" class="big">1</div>
          </div>
          <div style="margin-left:8px">
            <div class="muted small">이번 베팅</div>
            <div id="bet" class="big">1</div>
          </div>
          <div style="margin-left:auto;text-align:right">
            <div class="muted small">다음(승)</div>
            <div id="nextWin" class="big">2</div>
            <div class="muted small">다음(패)</div>
            <div id="nextLose" class="muted small">D</div>
          </div>
        </div>

        <div class="controls">
          <button id="winBtn" class="big-button">승리</button>
          <button id="loseBtn" class="lose big-button">패배</button>
          <button id="prevBtn" class="big-button" style="background:transparent;color:#facc15;border:1px solid rgba(250,204,21,0.15)">이전</button>
          <button id="resetBtn" class="big-button" style="background:transparent;color:#7dd3fc;border:1px solid rgba(125,211,252,0.15)">리셋</button>
          <div class="start-unit-wrapper">
            <label class="small muted">시작 유닛</label>
            <input id="startInput" type="number" value="1" min="1" />
            <button id="setStart" class="big-button" style="background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--accent)">설정</button>
          </div>
        </div>

        <div class="footer">
          <div class="hint">* 표시는 특별 단계. D = 패배 시 종료, WIN = 목표 달성</div>
          <div style="display:flex;gap:8px; flex-wrap: wrap;">
            <button id="exportBtn" style="background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--accent)">CSV 내보내기</button>
            <button id="clearLog" style="background:transparent;border:1px solid rgba(255,255,255,0.04);color:#fca5a5">히스토리 삭제</button>
          </div>
        </div>
      </div>

      <div class="card panel">
        <div class="log-header">
          <div>
            <strong>히스토리</strong>
            <div class="muted small">진행 기록 (최신 위)</div>
          </div>
          <div class="muted small">규칙표 내에서 다음 유닛을 찾습니다</div>
        </div>

        <div id="log" class="log"></div>
      </div>
    </div>
    
    <div class="disclaimer">
      본 시스템의 이용으로 발생하는 모든 결과에 대한 법적·재정적 책임은 이용자 본인에게 있으며, 운영자는 일체의 법적 책임을 지지 않습니다.
    </div>
  </div>

<script>
// 규칙표 데이터
const rules = {
  "1": {bet:"1", win:2, lose:"D", special:false},
  "2": {bet:"2", win:4, lose:"D", special:true},
  "3": {bet:"3", win:6, lose:"D", special:false},
  "4": {bet:"4", win:8, lose:"D", special:false},
  "5": {bet:"3", win:8, lose:2, special:true},
  "6": {bet:"3", win:9, lose:3, special:false},
  "7": {bet:"2", win:9, lose:5, special:true},
  "8": {bet:"3", win:11, lose:5, special:false},
  "9": {bet:"2", win:11, lose:7, special:true},
  "10": {bet:"3", win:13, lose:7, special:false},
  "11": {bet:"2", win:13, lose:9, special:true},
  "12": {bet:"1-2", win:15, lose:11, special:true},
  "13": {bet:"1", win:14, lose:12, special:true},
  "14": {bet:"1-2", win:17, lose:9, special:true},
  "15": {bet:"1", win:16, lose:14, special:true},
  "16": {bet:"2", win:18, lose:14, special:true},
  "17": {bet:"2", win:19, lose:15, special:false},
  "18": {bet:"1", win:19, lose:17, special:true},
  "19": {bet:"2", win:21, lose:17, special:true},
  "20": {bet:"3", win:23, lose:17, special:false},
  "21": {bet:"4", win:25, lose:17, special:true},
  "22": {bet:"3", win:25, lose:19, special:false},
  "23": {bet:"3", win:26, lose:20, special:false},
  "24": {bet:"4", win:28, lose:20, special:false},
  "25": {bet:"3", win:28, lose:22, special:true},
  "26": {bet:"2", win:28, lose:24, special:false},
  "27": {bet:"1", win:28, lose:26, special:false},
  "28": {bet:"2-4", win:34, lose:22, special:true},
  "30": {bet:"2", win:32, lose:28, special:false},
  "32": {bet:"4", win:36, lose:28, special:false},
  "34": {bet:"4", win:38, lose:30, special:true},
  "36": {bet:"2", win:38, lose:34, special:false},
  "38": {bet:"4", win:42, lose:34, special:true},
  "40": {bet:"6", win:46, lose:34, special:false},
  "42": {bet:"6", win:48, lose:36, special:true},
  "44": {bet:"4", win:48, lose:40, special:false},
  "45": {bet:"3", win:48, lose:42, special:false},
  "46": {bet:"2", win:48, lose:44, special:false},
  "47": {bet:"1", win:48, lose:46, special:false},
  "48": {bet:"6", win:54, lose:42, special:true},
  "51": {bet:"6", win:57, lose:45, special:false},
  "54": {bet:"3", win:57, lose:51, special:true},
  "57": {bet:"6", win:63, lose:51, special:true},
  "60": {bet:"9", win:69, lose:51, special:false},
  "63": {bet:"9", win:72, lose:54, special:true},
  "66": {bet:"9", win:75, lose:57, special:false},
  "69": {bet:"6", win:75, lose:63, special:false},
  "70": {bet:"10", win:80, lose:60, special:false},
  "72": {bet:"3", win:75, lose:69, special:true},
  "75": {bet:"5", win:80, lose:70, special:true},
  "80": {bet:"10", win:90, lose:70, special:true},
  "85": {bet:"10", win:95, lose:75, special:false},
  "90": {bet:"5", win:95, lose:85, special:true},
  "95": {bet:"10", win:105, lose:85, special:true},
  "100": {bet:"15", win:115, lose:85, special:false},
  "105": {bet:"15", win:120, lose:90, special:true},
  "110": {bet:"15", win:125, lose:95, special:false},
  "115": {bet:"10", win:125, lose:105, special:false},
  "120": {bet:"5", win:125, lose:115, special:true},
  "125": {bet:"5-10", win:140, lose:110, special:true},
  "130": {bet:"10-20", win:160, lose:100, special:false},
  "140": {bet:"10", win:150, lose:130, special:true},
  "150": {bet:"20", win:170, lose:130, special:true},
  "160": {bet:"10", win:170, lose:150, special:false},
  "170": {bet:"20", win:190, lose:150, special:true},
  "180": {bet:"10", win:190, lose:170, special:false},
  "190": {bet:"20", win:210, lose:170, special:true},
  "200": {bet:"30", win:230, lose:170, special:false},
  "210": {bet:"20", win:230, lose:190, special:true},
  "220": {bet:"30", win:250, lose:190, special:false},
  "230": {bet:"20", win:250, lose:210, special:true},
  "240": {bet:"10", win:250, lose:230, special:false},
  "250": {bet:"30", win:280, lose:220, special:true},
  "260": {bet:"20-40", win:320, lose:200, special:false},
  "280": {bet:"20", win:300, lose:260, special:true},
  "300": {bet:"40", win:340, lose:260, special:true},
  "320": {bet:"20", win:340, lose:300, special:false},
  "340": {bet:"40", win:380, lose:300, special:true},
  "360": {bet:"20", win:380, lose:340, special:false},
  "380": {bet:"40", win:420, lose:340, special:true},
  "400": {bet:"20-40", win:460, lose:340, special:false},
  "420": {bet:"40", win:460, lose:380, special:true},
  "440": {bet:"60", win:500, lose:380, special:false},
  "460": {bet:"40", win:500, lose:420, special:true},
  "480": {bet:"20", win:500, lose:460, special:false},
  "500": {bet:"40", win:"540", lose:460, special:true},
  "510": {bet:"30", win:540, lose:480, special:false},
  "540": {bet:"30", win:570, lose:510, special:true},
  "570": {bet:"60", win:630, lose:510, special:true},
  "600": {bet:"90", win:690, lose:510, special:false},
  "630": {bet:"90", win:720, lose:540, special:true},
  "660": {bet:"90", win:750, lose:570, special:false},
  "690": {bet:"60", win:750, lose:630, special:false},
  "700": {bet:"100", win:800, lose:600, special:false},
  "720": {bet:"30", win:750, lose:690, special:true},
  "750": {bet:"50", win:800, lose:700, special:true},
  "800": {bet:"100", win:900, lose:700, special:true},
  "850": {bet:"100", win:950, lose:750, special:false},
  "900": {bet:"50", win:950, lose:850, special:true},
  "950": {bet:"100", win:1050, lose:850, special:true},
  "1000": {bet:"150", win:1150, lose:850, special:false},
  "1050": {bet:"150", win:1200, lose:900, special:true},
  "1100": {bet:"150", win:1250, lose:950, special:false},
  "1150": {bet:"100", win:1250, lose:1050, special:false},
  "1200": {bet:"50", win:1250, lose:1150, special:true},
  "1250": {bet:"50-100", win:1400, lose:1100, special:true},
  "1300": {bet:"100-200", win:1600, lose:1000, special:false},
  "1400": {bet:"100", win:1500, lose:1300, special:true},
  "1500": {bet:"200", win:1700, lose:1300, special:true},
  "1600": {bet:"100", win:1700, lose:1500, special:false},
  "1700": {bet:"200", win:1900, lose:1500, special:true},
  "1800": {bet:"100", win:1900, lose:1700, special:false},
  "1900": {bet:"200", win:2100, lose:1700, special:true},
  "2000": {bet:"300", win:2300, lose:1700, special:false},
  "2100": {bet:"200", win:2300, lose:1900, special:true},
  "2200": {bet:"300", win:2500, lose:1900, special:false},
  "2300": {bet:"200", win:2500, lose:2100, special:true},
  "2400": {bet:"100", win:2500, lose:2300, special:false},
  "2500": {bet:"300", win:2800, lose:2200, special:true},
  "2600": {bet:"200-400", win:3200, lose:2000, special:false},
  "2800": {bet:"200", win:3000, lose:2600, special:true},
  "3000": {bet:"400", win:3400, lose:2600, special:true},
  "3200": {bet:"200", win:3400, lose:3000, special:false},
  "3400": {bet:"400", win:3800, lose:3000, special:true},
  "3600": {bet:"200", win:3800, lose:3400, special:false},
  "3800": {bet:"400", win:4200, lose:3400, special:true},
  "4000": {bet:"200-400", win:4600, lose:3400, special:false},
  "4200": {bet:"400", win:4600, lose:3800, special:true},
  "4400": {bet:"600", win:5000, lose:3800, special:false},
  "4600": {bet:"400", win:5000, lose:4200, special:true},
  "4800": {bet:"200", win:5000, lose:4600, special:false},
  "5000": {bet:"WIN", win:"WIN", lose:null, special:true}
};

let current = 1;
let history = [];

const el = {
  current: document.getElementById('current'),
  bet: document.getElementById('bet'),
  nextWin: document.getElementById('nextWin'),
  nextLose: document.getElementById('nextLose'),
  log: document.getElementById('log'),
  winBtn: document.getElementById('winBtn'),
  loseBtn: document.getElementById('loseBtn'),
  prevBtn: document.getElementById('prevBtn'),
  resetBtn: document.getElementById('resetBtn'),
  startInput: document.getElementById('startInput'),
  setStart: document.getElementById('setStart'),
  exportBtn: document.getElementById('exportBtn'),
  clearLog: document.getElementById('clearLog')
};

function render() {
  el.current.textContent = current;
  const rule = rules[String(current)];
  if(!rule){
    el.bet.textContent = '—';
    el.nextWin.textContent = '—';
    el.nextLose.textContent = '—';
    return;
  }
  el.bet.textContent = rule.bet;
  el.nextWin.textContent = rule.win;
  el.nextLose.textContent = (rule.lose===null?'-':rule.lose);
}

function pushHistory(action, from, to, bet, special){
  const row = {time: new Date().toLocaleString(), action, from, to, bet, special};
  history.unshift(row);
  renderLog();
}

function renderLog(){
  el.log.innerHTML = history.map(h=>{
    const specialMark = h.special?"*":"";
    return `<div class="row"><div><div class="small">${h.time} ${specialMark}</div><div><strong>${h.action}</strong> ${h.from} → ${h.to}</div></div><div class="small muted">bet:${h.bet}</div></div>`
  }).join('');
}

el.winBtn.addEventListener('click',()=>{
  const rule = rules[String(current)];
  if(!rule){ alert('해당 유닛 규칙이 없습니다.'); return; }
  const next = rule.win;
  pushHistory('승리', current, next, rule.bet, rule.special);
  if(next === 'WIN'){
    current = 'WIN'; render(); alert('🎉 WIN! 목표 달성했습니다.'); return; }
  current = next;
  render();
});

el.loseBtn.addEventListener('click',()=>{
  const rule = rules[String(current)];
  if(!rule){ alert('해당 유닛 규칙이 없습니다.'); return; }
  const next = rule.lose;
  pushHistory('패배', current, next, rule.bet, rule.special);
  if(next === 'D' || next === null){
    current = 'D'; render(); alert('종료: 패배로 인한 종료(D)입니다.'); return;
  }
  current = next;
  render();
});

el.prevBtn.addEventListener('click', ()=>{
  if(history.length === 0){ 
    alert('되돌아갈 기록이 없습니다.'); 
    return; 
  }
  const lastRecord = history.shift();
  current = lastRecord.from;
  render();
  renderLog();
});

el.resetBtn.addEventListener('click',()=>{
  current = Number(el.startInput.value) || 1;
  history = [];
  render(); renderLog();
});

el.setStart.addEventListener('click', ()=>{
  const v = Number(el.startInput.value);
  if(!v || !rules[String(v)]){ alert('유효한 시작 유닛을 입력하세요. 예: 1'); return; }
  current = v; render();
});

el.exportBtn.addEventListener('click', ()=>{
  if(history.length===0){ alert('내보낼 히스토리가 없습니다.'); return; }
  const csv = ['time,action,from,to,bet,special', ...history.map(h=>`${h.time},${h.action},${h.from},${h.to},${h.bet},${h.special}`)].join('\n');
  const blob = new Blob([csv], {type:'text/csv'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url; a.download = 'gattahu_history.csv'; a.click(); URL.revokeObjectURL(url);
});

el.clearLog.addEventListener('click', ()=>{ history=[]; renderLog(); });

// 초기 렌더
render();
</script>
</body>
</html>